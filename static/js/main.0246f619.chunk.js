(this.webpackJsonpnonograms=this.webpackJsonpnonograms||[]).push([[0],{22:function(t,e,n){},23:function(t,e,n){},31:function(t,e){},32:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(2),s=n(15),o=n.n(s),l=(n(22),n(10)),a=(n(23),n(3)),u=n(4),c=function(){function t(e){if(Object(a.a)(this,t),this.groups=e,this.gn=e.length,this.gn>0){this.restLength=new Array(this.gn).fill(0),this.restLength[this.gn-1]=e[this.gn-1];for(var n=this.gn-2;n>=0;n--)this.restLength[n]=e[n]+1+this.restLength[n+1]}}return Object(u.a)(t,[{key:"setCells",value:function(t){this.length=t.length,this.cells=t,this.sure=new Array(this.length).fill(0);for(var e=0;e<this.length;e++)0!==this.cells[e]&&(this.sure[e]=1);this.cur=new Array(this.length).fill(0),this.ansLine=new Array(this.length).fill(0)}},{key:"checkFinal",value:function(t){for(var e=t;e<this.length;e++)if(1===this.cells[e])return;for(var n=0;n<this.length;n++)0===this.ansLine[n]?this.ansLine[n]=this.cur[n]:this.ansLine[n]!==this.cur[n]&&(this.ansLine[n]=2,this.cells[n]=0,this.sure[n]=1);this.realFound++}},{key:"rec",value:function(t,e){if(!(this.realFound>0)&&!(e+this.restLength[t]>this.length)){for(var n=!0,r=e;r<e+this.groups[t];r++){if(-1===this.cells[r]){n=!1;break}this.cur[r]=1}if(e+this.groups[t]<this.length&&1===this.cells[e+this.groups[t]]&&(n=!1),n)if(t===this.gn-1)this.checkFinal(e+this.groups[t]);else for(var i=e+this.groups[t]+1;i<this.length&&(this.rec(t+1,i),1!==this.cells[i]);++i);for(var s=e;s<e+this.groups[t];s++)this.cur[s]=0}}},{key:"isFeasible",value:function(){if(0===this.gn){for(var t=0;t<this.length;++t)if(1===this.cells[t])return!1;return!0}this.realFound=0;for(var e=0;e<this.length&&(this.rec(0,e),1!==this.cells[e]);++e);return 0!==this.realFound}},{key:"isModificationFeasible",value:function(t,e){if(2===this.ansLine[t]||this.ansLine[t]===e)return!0;var n=this.cells[t];this.cells[t]=e;var r=this.isFeasible();return this.cells[t]=n,r}},{key:"solve",value:function(){if(!this.isFeasible())return!1;for(var t=0;t<this.length;++t)1!==this.sure[t]&&(this.isModificationFeasible(t,1)?this.isModificationFeasible(t,-1)?this.cells[t]=0:this.cells[t]=1:this.cells[t]=-1,this.sure[t]=1);return!0}}]),t}(),h=function(){function t(e,n){var r=this;Object(a.a)(this,t),this.width=n.length,this.height=e.length,this.matrix=Array.from({length:this.height},(function(){return new Array(r.width).fill(0)})),this.rows=e.map((function(t){return new c(t)})),this.columns=n.map((function(t){return new c(t)}))}return Object(u.a)(t,null,[{key:"solve",value:function(e,n){var r=new t(e,n);return{solved:r.solve(),solution:r.solution()}}}]),Object(u.a)(t,[{key:"solution",value:function(){return this.matrix.map((function(t){return t.map((function(t){return-1===t?0:t}))}))}},{key:"getColumn",value:function(t){var e=this;return Array.from({length:this.height},(function(n,r){return e.matrix[r][t]}))}},{key:"updateMatrix",value:function(t,e,n){0===this.matrix[t][e]&&0!==n&&(this.matrix[t][e]=n,this.changed=!0)}},{key:"isComplete",value:function(){for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)if(0===this.matrix[t][e])return!1;return!0}},{key:"process",value:function(){do{this.changed=!1,this.processRows(),this.processColumns()}while(this.changed);return!0}},{key:"processRows",value:function(){for(var t=0;t<this.height;t++){if(this.rows[t].setCells(this.matrix[t]),!this.rows[t].solve())return!1;for(var e=0;e<this.width;e++)this.updateMatrix(t,e,this.rows[t].cells[e])}}},{key:"processColumns",value:function(){for(var t=0;t<this.width;t++){if(this.columns[t].setCells(this.getColumn(t)),!this.columns[t].solve())return!1;for(var e=0;e<this.height;e++)this.updateMatrix(e,t,this.columns[t].cells[e])}}},{key:"solve",value:function(){return!!this.process()&&!!this.isComplete()}}]),t}(),f=function(t,e){var n=h.solve(t,e);return{solved:n.solved,solution:n.solution}},v=n(16),d=n.n(v),p=n(8),m=function(t){for(var e=[],n=0,r=0;r<=t.length;r++)void 0!==t[r]&&1===t[r]?n++:n>0&&(e.push({total:n,start:r-n,length:n}),n=0);return 0===e.length&&e.push({total:n,start:0,length:t.length}),e},g=function(t){return function(t){return t.reduce((function(t,e){return e.map((function(n,r){return[].concat(Object(p.a)(t[r]||[]),[e[r]])}))}),[])}(t).map((function(t){return m(t)}))},w=function(t){return(t||[]).map((function(t){return m(t)}))};function b(t,e,n){return Math.floor(n()*(e-t+1)+t)}var j=function(t,e,n){return Array.from({length:e},(function(){for(var e=[],r=b(1,n,t),i=b(0,1,t);e.length<n;)e.push.apply(e,Object(p.a)(new Array(r).fill(i))),i=1-i,r=b(1,n-e.length,t);return e}))},O=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(0===e.length)throw new Error("At least one argument is required");return e.map((function(t){return t.toString()})).filter((function(t){return""!==t})).join("_")},y=n(13),L=n(12),k=new(function(t){Object(y.a)(n,t);var e=Object(L.a)(n);function n(){return Object(a.a)(this,n),e.apply(this,arguments)}return n}(function(){function t(e){for(var n in Object(a.a)(this,t),e)this[n]=e[n];Object.freeze(this)}return Object(u.a)(t,[{key:"keys",value:function(){return Object.keys(this)}}]),t}()))({UNKNOWN:-1,EMPTY:0,FILLED:1});var N=function(t){var e=t.hints,n=t.line,i=e.map((function(t,e){var i={};return function(t,e){return(e||[]).slice(t.start,t.start+t.length).every((function(e){return 0===t.total&&e===k.EMPTY||e===k.FILLED}))}(t,n)&&(i={color:"#AAA"}),Object(r.jsx)("div",{className:"hint-num",style:i,children:t.total},O(t,e))}));return Object(r.jsx)("div",{className:"hint-cell",children:i})};var x=function(t){var e=t.puzzle,n=t.data,i=t.className,s=t.type,o=n.map((function(t,i){var o="row"===s?e[i]:e.map((function(t){return t[i]}));return Object(r.jsx)(N,{hints:t,line:o},O(n,t,i))}));return Object(r.jsx)("div",{className:"".concat(i),children:o})},E=n(5),H=Object(i.memo)((function(t){var e=t.value,n=t.row,i=t.column,s=["crossed","filled"][e]||"";return Object(r.jsx)("div",{className:"nonogram-cell ".concat(s),title:"row ".concat(n+1,", column ").concat(i+1),"data-row":n,"data-column":i})})),C=function(t){Object(y.a)(n,t);var e=Object(L.a)(n);function n(t){var r;return Object(a.a)(this,n),(r=e.call(this,t)).lastCell=null,r.cellState=null,r.pointerDownHandler=r.pointerDownHandler.bind(Object(E.a)(r)),r.pointerMoveHandler=r.pointerMoveHandler.bind(Object(E.a)(r)),r.pointerUpHandler=r.pointerUpHandler.bind(Object(E.a)(r)),r.pointerLeaveHandler=r.pointerLeaveHandler.bind(Object(E.a)(r)),r}return Object(u.a)(n,[{key:"disableContextMenu",value:function(t){t.preventDefault()}},{key:"disableTouchAction",value:function(t){t.preventDefault()}},{key:"getCellFromEvent",value:function(t){var e="mouse"===t.pointerType?t.target:document.elementFromPoint(t.clientX,t.clientY);if(e)return e.closest(".nonogram-cell")}},{key:"pointerDownHandler",value:function(t){this.lastCell=null,this.cellState=null;var e=this.getCellFromEvent(t);e&&(this.lastCell=e,1===t.buttons?this.props.answer[e.dataset.row][e.dataset.column]===k.EMPTY?this.cellState=k.UNKNOWN:this.props.answer[e.dataset.row][e.dataset.column]===k.FILLED?this.cellState=k.EMPTY:this.cellState=k.FILLED:2===t.buttons&&(this.cellState=k.EMPTY),null!==this.cellState&&(this.props.onUpdateAnswer(e.dataset.row,e.dataset.column,this.cellState),document.addEventListener("pointermove",this.pointerMoveHandler),document.addEventListener("pointerup",this.pointerUpHandler)))}},{key:"pointerMoveHandler",value:function(t){var e=this.getCellFromEvent(t);if(e&&this.lastCell!==e){var n=this.props.answer[e.dataset.row][e.dataset.column];(this.cellState===k.UNKNOWN&&n!==k.UNKNOWN||this.cellState!==k.UNKNOWN&&n===k.UNKNOWN)&&this.props.onUpdateAnswer(e.dataset.row,e.dataset.column,this.cellState),this.lastCell=e}}},{key:"pointerUpHandler",value:function(t){document.removeEventListener("pointermove",this.pointerMoveHandler),document.removeEventListener("pointerup",this.pointerUpHandler),this.cellState=null,this.lastCell=null,this.props.actionCompleted()}},{key:"pointerLeaveHandler",value:function(t){document.removeEventListener("pointermove",this.pointerMoveHandler)}},{key:"renderGridCells",value:function(){return this.props.answer.map((function(t,e){return t.map((function(t,n){return Object(r.jsx)(H,{value:t,row:e,column:n},O(e,n))}))}))}},{key:"render",value:function(){return Object(r.jsx)("div",{className:"nonogram-grid grid-".concat(this.props.cols,"x").concat(this.props.rows),onPointerDown:this.pointerDownHandler,onPointerLeave:this.pointerLeaveHandler,onTouchEnd:this.disableTouchAction,onContextMenu:this.disableContextMenu,children:this.renderGridCells()})}}]),n}(i.Component);var M=function(t){var e=t.data,n=t.rowHints,s=t.columnHints,o=t.newPuzzle,a=Object(i.useState)((function(){for(var t=Array.from({length:e.length},(function(){return new Array(e[0].length).fill(k.UNKNOWN)})),n=0;n<e.length;n++){var r=e[n];if(0===r.reduce((function(t,e){return t+e}),0))for(var i=0;i<r.length;i++)t[n][i]=k.EMPTY}for(var s=function(n){var r=e.map((function(t){return t[n]}));if(0===r.reduce((function(t,e){return t+e}),0))for(var i=0;i<r.length;i++)t[i][n]=k.EMPTY},o=0;o<e.length;o++)s(o);return t})),u=Object(l.a)(a,2),c=u[0],h=u[1];return Object(r.jsx)("div",{className:"disable-text-selection",children:Object(r.jsxs)("div",{className:"full-grid",children:[Object(r.jsx)(x,{type:"column",data:s,puzzle:c,className:"column-hints"}),Object(r.jsx)(x,{type:"row",data:n,puzzle:c,className:"row-hints"}),Object(r.jsx)(C,{rows:n.length,cols:s.length,answer:c,onUpdateAnswer:function(t,e,n){c[t][e]=n,h(Object(p.a)(c))},actionCompleted:function(){(function(){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n]===k.FILLED&&c[t][n]!==k.FILLED||e[t][n]!==k.FILLED&&c[t][n]===k.FILLED)return!1;return!0})()&&o()}})]})})},F=d()("Javier");var A=function(){var t=[[5,5],[10,5]],e=function(){for(;;){var e=Object(l.a)(t[Math.floor(F()*t.length)],2),n=e[0],r=e[1],i=j(F,n,r),s=w(i),o=g(i),a=f(s.map((function(t){return t.map((function(t){return t.total}))})),o.map((function(t){return t.map((function(t){return t.total}))})));if(console.log("NEW PUZZLE ".concat(r,"x").concat(n),a.solved,a.solution),a.solved)return{id:(new Date).getTime(),puzzle:a.solution,rowHints:s,columnHints:o}}},n=Object(i.useState)((function(){return e()})),s=Object(l.a)(n,2),o=s[0],a=s[1];return Object(r.jsx)(M,{data:o.puzzle,rowHints:o.rowHints,columnHints:o.columnHints,newPuzzle:function(){a(e())}},o.id)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(r.jsx)(i.StrictMode,{children:Object(r.jsx)(A,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.0246f619.chunk.js.map